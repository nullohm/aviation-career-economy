<Window x:Class="Ace.App.Views.Dialogs.FlightMapWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        xmlns:mapsui="clr-namespace:Mapsui.UI.Wpf;assembly=Mapsui.UI.Wpf"
        xmlns:controls="clr-namespace:Ace.App.Controls"
        Title="Flight Map"
        Width="900" Height="650"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Foreground="{StaticResource ForegroundBrush}"
        ResizeMode="CanResize"
        WindowStartupLocation="CenterOwner">

    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome CaptionHeight="36" CornerRadius="8" GlassFrameThickness="0" ResizeBorderThickness="5"/>
    </shell:WindowChrome.WindowChrome>

    <Border Background="{StaticResource BgPrimary}"
            BorderBrush="#50FFFFFF"
            BorderThickness="1"
            CornerRadius="8"
            Margin="8">
        <Border.Effect>
            <DropShadowEffect Color="Black" BlurRadius="20" Opacity="0.6" ShadowDepth="4"/>
        </Border.Effect>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="36"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title Bar -->
        <Border Grid.Row="0" Background="{StaticResource CardBg}" CornerRadius="8,8,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="12,0,0,0">
                    <TextBlock x:Name="TxtTitle" Text="Flight Map" FontSize="14" Style="{StaticResource HeadingText}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="TxtRoute" Foreground="{StaticResource SubtleForegroundBrush}" FontSize="12" VerticalAlignment="Center" Margin="12,0,0,0"/>
                </StackPanel>

                <Button Grid.Column="1" Name="BtnClose" Width="40" Height="28" Content="{StaticResource IconClose}"
                        Click="BtnClose_Click" ToolTip="Close"
                        Style="{StaticResource WindowCloseButtonStyle}"
                        shell:WindowChrome.IsHitTestVisibleInChrome="True" Margin="0,0,8,0"/>
            </Grid>
        </Border>

        <!-- Map -->
        <mapsui:MapControl x:Name="MapControl" Grid.Row="1"/>

        <!-- Info Panel -->
        <Border Grid.Row="1" Background="#E01A1A1A" CornerRadius="8" Padding="12,8"
                HorizontalAlignment="Left" VerticalAlignment="Top" Margin="12"
                BorderBrush="#40FFFFFF" BorderThickness="1">
            <Border.Effect>
                <DropShadowEffect BlurRadius="12" ShadowDepth="2" Opacity="0.4" Color="Black"/>
            </Border.Effect>
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                    <Ellipse Width="10" Height="10" Fill="#4CAF50" Margin="0,0,6,0"/>
                    <TextBlock x:Name="TxtDeparture" Text="EDDF" Foreground="White" FontWeight="SemiBold" FontSize="12"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                    <Ellipse Width="10" Height="10" Fill="#2196F3" Margin="0,0,6,0"/>
                    <TextBlock x:Name="TxtArrival" Text="EDDM" Foreground="White" FontWeight="SemiBold" FontSize="12"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <Ellipse Width="10" Height="10" Fill="#F44336" Margin="0,0,6,0"/>
                    <TextBlock x:Name="TxtAircraft" Text="Current Position" Foreground="White" FontSize="11"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Unified Legend Panel (Left Bottom) -->
        <controls:MapLegendPanelControl x:Name="LegendPanel" Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="16,0,0,48"/>

        <!-- Scale Control (Left Bottom) -->
        <controls:MapScaleControl x:Name="ScaleControl" Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="16,0,0,16"/>

        <!-- Map Layer Toggle (Center Bottom) -->
        <Border Grid.Row="1"
                HorizontalAlignment="Center"
                VerticalAlignment="Bottom"
                Margin="0,0,0,16"
                Background="{StaticResource CardBg}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="6"
                Padding="4">
            <Border.Effect>
                <DropShadowEffect BlurRadius="8" ShadowDepth="1" Opacity="0.3" Color="Black"/>
            </Border.Effect>
            <StackPanel Orientation="Horizontal">
                <Button x:Name="StreetLayerButton"
                        Content="Street"
                        Width="70"
                        Height="32"
                        FontSize="11"
                        Margin="0,0,2,0"
                        Click="StreetLayerButton_Click"
                        Style="{StaticResource IconButtonStyle}"/>
                <Button x:Name="TerrainLayerButton"
                        Content="Terrain"
                        Width="70"
                        Height="32"
                        FontSize="11"
                        Margin="0,0,2,0"
                        Click="TerrainLayerButton_Click"
                        Style="{StaticResource IconButtonStyle}"/>
                <Button x:Name="SatelliteLayerButton"
                        Content="Satellite"
                        Width="70"
                        Height="32"
                        FontSize="11"
                        Click="SatelliteLayerButton_Click"
                        Style="{StaticResource IconButtonStyle}"/>
            </StackPanel>
        </Border>

        <!-- Flight Info Panel -->
        <Border Grid.Row="1" Background="#E01A1A1A" CornerRadius="8" Padding="12,8"
                HorizontalAlignment="Right" VerticalAlignment="Top" Margin="12"
                BorderBrush="#40FFFFFF" BorderThickness="1">
            <Border.Effect>
                <DropShadowEffect BlurRadius="12" ShadowDepth="2" Opacity="0.4" Color="Black"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="8"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="ALT" Foreground="{StaticResource SubtleForegroundBrush}" FontSize="10"/>
                <TextBlock Grid.Row="0" Grid.Column="2" x:Name="TxtAltitude" Text="---" Foreground="White" FontWeight="SemiBold" FontSize="12"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="GS" Foreground="{StaticResource SubtleForegroundBrush}" FontSize="10"/>
                <TextBlock Grid.Row="1" Grid.Column="2" x:Name="TxtSpeed" Text="---" Foreground="White" FontWeight="SemiBold" FontSize="12"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="HDG" Foreground="{StaticResource SubtleForegroundBrush}" FontSize="10"/>
                <TextBlock Grid.Row="2" Grid.Column="2" x:Name="TxtHeading" Text="---" Foreground="White" FontWeight="SemiBold" FontSize="12"/>
            </Grid>
        </Border>

        <!-- Bottom Status -->
        <Border Grid.Row="2" Background="{StaticResource CardBg}" Padding="12,8" CornerRadius="0,0,8,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="TxtStatus" Text="Click on an airport marker for details"
                           Foreground="{StaticResource SubtleForegroundBrush}" FontSize="11" VerticalAlignment="Center"/>
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="Progress: " Foreground="{StaticResource SubtleForegroundBrush}" FontSize="11" VerticalAlignment="Center"/>
                    <TextBlock x:Name="TxtProgress" Text="0%" Foreground="{StaticResource AccentBrush}" FontWeight="SemiBold" FontSize="11" VerticalAlignment="Center"/>
                    <TextBlock Text=" | " Foreground="{StaticResource SubtleForegroundBrush}" FontSize="11" VerticalAlignment="Center"/>
                    <TextBlock Text="Remaining: " Foreground="{StaticResource SubtleForegroundBrush}" FontSize="11" VerticalAlignment="Center"/>
                    <TextBlock x:Name="TxtRemaining" Text="--- NM" Foreground="White" FontWeight="SemiBold" FontSize="11" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
    </Border>
</Window>
